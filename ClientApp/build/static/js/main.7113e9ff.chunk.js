(this.webpackJsonpazure_communication_services_calling_sample=this.webpackJsonpazure_communication_services_calling_sample||[]).push([[0],{188:function(e,t){},275:function(e,t,n){e.exports=n.p+"static/media/hero.7c037def.svg"},276:function(e,t,n){e.exports=n.p+"static/media/basicCreditCard.c2f80f80.svg"},308:function(e,t,n){e.exports=n(489)},313:function(e,t,n){},487:function(e){e.exports=JSON.parse('{"name":"azure_communication_services_calling_sample","version":"1.0.0","private":true,"description":"This is a sample application to show how the Azure Communication Services Calling Web SDK can be used to build a group calling experience. The client-side application is a React based user interface which uses Redux for handling complex state while leveraging Microsoft Fluent UI for how things look. Powering this front-end is a C# web application powered by ASP.net Core to connect this application with Azure.","dependencies":{"@azure/communication-calling":"1.1.0-beta.2","@azure/communication-common":"1.0.0","@azure/communication-identity":"1.0.0-beta.4","@azure/storage-blob":"^12.6.0","@fluentui/react":"^7.117.1","@fluentui/react-icons-northstar":"^0.51.0","@fluentui/react-northstar":"^0.51.0","@types/preval.macro":"^3.0.0","@types/react":"^16.9.49","@types/react-dom":"^16.9.8","@types/react-redux":"^7.1.9","@types/uuid":"^8.3.0","bootstrap":"^4.1.3","jquery":"^3.5.1","merge":"^1.2.1","node-forge":"0.10.0","oidc-client":"^1.9.0","preval.macro":"^5.0.0","react":"^16.8.0","react-dom":"^16.8.0","react-redux":"^7.2.0","react-router-bootstrap":"^0.25.0","react-router-dom":"^5.1.2","react-scripts":"^3.4.3","reactstrap":"^8.4.1","redux":"^4.0.5","redux-devtools-extension":"^2.13.8","redux-thunk":"^2.3.0","rimraf":"^2.6.2","source-map-explorer":"^2.5.0","uuid":"^8.1.0","y18n":">=4.0.1"},"devDependencies":{"@types/jest":"^26.0.22","ajv":"^6.9.1","cross-env":"^5.2.0","eslint":"^6.8.0","eslint-config-prettier":"^7.2.0","eslint-config-react-app":"^5.2.0","eslint-plugin-flowtype":"^4.6.0","eslint-plugin-import":"^2.20.1","eslint-plugin-jsx-a11y":"^6.2.3","eslint-plugin-react":"^7.18.3","nan":"^2.14.1","prettier":"2.0.5","typescript":"^3.9.7"},"eslintConfig":{"extends":"react-app"},"scripts":{"analyze":"source-map-explorer \'build/static/js/*.js\'","start":"rimraf ./build && react-scripts start","build":"react-scripts build","test":"cross-env CI=true react-scripts test --env=jsdom","eject":"react-scripts eject","prettier":"prettier --write --config .prettierrc **/*.js **/*.ts","prettier:check":"prettier --check --config .prettierrc **/*.js **/*.ts","lint":"eslint */**/*.{ts,tsx} --max-warnings 100 && echo Lint completed.","lint:quiet":"eslint */**/*.{ts,tsx} --max-warnings 100 --quiet && echo Lint completed."},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},489:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(100),c=n.n(i),o=(n(313),n(21)),s=n(6),l=n.n(s),d=n(17),u=n(49),m=n(570),p=n(581),h=n(579),g=n(583),f=n(577),v=n(576),b=n(274),E=n(38),S=n(547),O=n(548),I=n(549),C=n(550),j=n(551),w=n(552),y=n(553),x=n(12),k=Object(x.A)().palette,D=Object(x.F)({height:"3.75rem",padding:"0 0.8125rem",display:"inline-block",borderRadius:7,overflow:"hidden"}),R=Object(x.F)({position:"relative",right:"34%"}),N=Object(x.F)({backgroundColor:k.white,width:"2rem",height:"3.75rem",border:"0.125rem",borderRadius:2,marginRight:"0.4375rem",color:k.neutralSecondary}),A=Object(x.F)(N,{color:k.neutralLight}),P=Object(x.F)({backgroundColor:"#d74654",width:"6.5625rem",height:"2.1875rem",border:"0.125rem",marginRight:"0.75rem",marginLeft:"0.75rem",borderRadius:2,color:k.white,selectors:{":focus":{color:k.white},":hover":{color:k.white},":active":{color:k.white}}}),T=Object(x.F)({color:k.white,padding:"0.3125rem",fontSize:"0.875rem",lineHeight:"3.75rem"}),_=Object(x.F)({width:"100%"}),L=function(e){var t="Denied"!==e.cameraPermission&&e.cameraActive,n="Denied"===e.cameraPermission,r="Denied"!==e.cameraPermission?e.onCameraChange:void 0,i="Denied"!==e.microphonePermission&&e.micActive,c="Denied"===e.microphonePermission,o="Denied"!==e.microphonePermission?e.onMicChange:void 0,s=!!e.activeScreenShareStream;return a.createElement(m.a,{className:D},a.createElement(f.a,{onKeyDownCapture:function(t){13===t.keyCode&&e.localVideoRendererIsBusy&&t.preventDefault()},disabled:n,onClick:r,className:N},a.createElement("div",{className:_},t?a.createElement(S.a,{size:"medium"}):a.createElement(O.a,{size:"medium"}))),a.createElement(f.a,{onClick:o,disabled:c,className:N},a.createElement("div",{className:_},i?a.createElement(I.a,{size:"medium"}):a.createElement(C.a,{size:"medium"}))),e.isLocalScreenShareSupportedInBrowser()&&a.createElement(f.a,{disabled:s,onClick:e.onScreenShareChange,className:s?A:N},a.createElement("div",{className:_},e.screenShareActive?a.createElement(j.a,{size:"medium"}):a.createElement(w.a,{size:"medium"}))),a.createElement(f.a,{onClick:e.onEndCallClick,className:e.compressedMode?N:P},a.createElement("div",{className:_},a.createElement(y.a,{size:"medium"}),!e.compressedMode&&a.createElement("span",{className:T},"Leave"))))},F=n(568),V={childrenGap:"1.5rem"},M={childrenGap:"0.75rem"},z={caretDownWrapper:{height:"2.5rem",lineHeight:"2.5rem"},dropdownItem:{fontWeight:600,fontSize:"0.875rem",height:"2.5rem"},dropdown:{height:"2.5rem"},title:{fontWeight:600,fontSize:"0.875rem",height:"2.5rem",lineHeight:"2.3125rem"},label:{fontWeight:600,fontSize:"0.875rem"}},W=Object(x.F)({width:"100%",maxWidth:"18.75rem",minWidth:"12.5rem",maxHeight:"14.125rem",marginTop:"2.125rem"}),B=function(e){var t=function(e){return e.map((function(e){return{val:e,key:e.id,text:""===e.name?e.deviceType:e.name}}))};return r.a.createElement(m.a,{className:W,tokens:V},r.a.createElement(F.a,{placeholder:"Select an option",label:"Camera",options:t(e.videoDeviceList),styles:z,disabled:0===e.videoDeviceList.length,defaultSelectedKey:e.videoDeviceInfo?e.videoDeviceInfo.id:"",onChange:function(){var t,n=null!==(t=arguments.length<=2?void 0:arguments[2])&&void 0!==t?t:0;e.setVideoDeviceInfo(e.videoDeviceList[n])}}),r.a.createElement(m.a,{tokens:M},r.a.createElement(F.a,{placeholder:"Select an option",label:"Microphone",styles:z,disabled:0===e.audioDeviceList.length,options:t(e.audioDeviceList),defaultSelectedKey:e.audioDeviceInfo?e.audioDeviceInfo.id:"",onChange:function(){var t,n=null!==(t=arguments.length<=2?void 0:arguments[2])&&void 0!==t?t:0;e.setAudioDeviceInfo(e.audioDeviceList[n]),e.deviceManager.selectMicrophone(e.audioDeviceList[n])}})))},U=n(61),H=n(249),G=n(13),K={getAppServiceUrl:function(){return window.location.origin},getTokenForUser:function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/token");case 2:if(!(t=e.sent).ok){e.next=5;break}return e.abrupt("return",t.json());case 5:throw new Error("Invalid token response");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getFeedbackSettings:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/feedbackSettings");case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Failed to get blob settings from server!");case 5:return e.next=7,t.json();case 7:return n=e.sent,e.abrupt("return",Object(G.a)(Object(G.a)({},n),{},{isFeedbackEnabled:"true"===n.isFeedbackEnabled.toLowerCase()}));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getRecordingSettings:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/recordingSettings");case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Failed to get recording settings from server!");case 5:return e.next=7,t.json();case 7:return n=e.sent,e.abrupt("return",Object(G.a)(Object(G.a)({},n),{},{isRecordingEnabled:"true"===n.isRecordingEnabled.toLowerCase()}));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),getRefreshedTokenForUser:function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/refreshToken/".concat(t));case 2:if(!(n=e.sent).ok){e.next=8;break}return e.next=6,n.json();case 6:return a=e.sent,e.abrupt("return",a.token);case 8:throw new Error("Invalid token response");case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),startRecording:function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/recording/startRecording?serverCallId="+t);case 3:if(!(n=e.sent).ok){e.next=6;break}return e.abrupt("return",{message:""});case 6:return e.next=8,n.json();case 8:return a=e.sent,r=a.message||"Recording could not be started",e.abrupt("return",{message:r});case 13:return e.prev=13,e.t0=e.catch(0),e.abrupt("return",{message:"Recording could not be started"});case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),stopRecording:function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/recording/stopRecording?serverCallId="+t);case 3:if(!e.sent.ok){e.next=6;break}return e.abrupt("return",{message:""});case 6:return e.abrupt("return",{message:"Recording could not be stopped"});case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",{message:"Recording could not be stopped"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),isSelectedAudioDeviceInList:function(e,t){return t.filter((function(t){return t.name===e.name})).length>0},isSelectedVideoDeviceInList:function(e,t){return t.filter((function(t){return t.name===e.name})).length>0},isMobileSession:function(){return!!window.navigator.userAgent.match(/(iPad|iPhone|iPod|Android|webOS|BlackBerry|Windows Phone)/g)},isSmallScreen:function(){return window.innerWidth<700||window.innerHeight<400},isUnsupportedBrowser:function(){return!!window.navigator.userAgent.match(/(Firefox)/g)},getId:function(e){switch(e.kind){case"communicationUser":return e.communicationUserId;case"phoneNumber":return e.phoneNumber;case"microsoftTeamsUser":return e.microsoftTeamsUserId;case"unknown":return e.id;default:return""}},getStreamId:function(e,t){return"".concat(e,"-").concat(t.id,"-").concat(t.mediaStreamType)},isOnIphoneAndNotSafari:function(){var e=navigator.userAgent;return!(!e.includes("iPhone")||!e.includes("FxiOS")&&!e.includes("CriOS"))},getBuildTime:function(){return"7/6/2021, 11:57:11 AM"}},Y=function(e){return{type:"SET_CALL_AGENT",callAgent:e}},J=function(e){return{type:"CALL_ADDED",call:e}},q=function(e){return{type:"CALL_REMOVED",call:void 0,incomingCallEndReason:"Incoming"===e.direction?e.callEndReason:void 0,callEndReason:e.callEndReason}},X=function(e){return{type:"SET_CALL_STATE",callState:e}},Q=function(e){return{type:"SET_PARTICIPANTS",remoteParticipants:e}},Z=function(e){return{type:"SET_RECORDING_ACTIVE",active:e}},$=function(e){return{type:"SET_TRANSCRIBING_ACTIVE",active:e}},ee=function(e){return{type:"SET_DOMINANT_PARTICIPANTS",dominantParticipants:e}},te=function(e){return{type:"SET_MIC",mic:e}},ne=function(e){return{type:"SET_SHARE_SCREEN",shareScreen:e}},ae=function(e){return{type:"SET_DEVICE_MANAGER",deviceManager:e}},re=function(e){return{type:"SET_MICROPHONE_PERMISSION",microphonePermission:e}},ie=function(e){return{type:"SET_CAMERA_PERMISSION",cameraPermission:e}},ce=function(e){return{type:"SET_AUDIO_DEVICE_INFO",audioDeviceInfo:e}},oe=function(e){return{type:"SET_VIDEO_DEVICE_INFO",videoDeviceInfo:e}},se=function(e){return{type:"SET_AUDIO_DEVICE_LIST",audioDeviceList:e}},le=function(e){return{type:"SET_VIDEO_DEVICE_LIST",videoDeviceList:e}},de=function(e){return{type:"SET_USERID",userId:e}},ue=function(e){return{type:"SET_CALL_CLIENT",callClient:e}},me=function(e){return{type:"SET_LOCAL_STREAM",localVideoStream:e}},pe=function(e,t){return{type:"ADD_SCREENSHARE_STREAM",stream:e,user:t}},he=n(70),ge=n(46),fe=n(59),ve=function(){function e(t,n){Object(ge.a)(this,e),this.participantId=void 0,this.timeStamp=void 0,this.isUnMuted=void 0,this.participantId=t,this.isUnMuted=n,this.timeStamp=Date.now()}return Object(fe.a)(e,[{key:"process",value:function(e){this.isUnMuted&&!e.isUnMuted&&(e.lastUnMuted=this.timeStamp),e.isUnMuted=this.isUnMuted}}]),e}(),be=function(){function e(t,n){Object(ge.a)(this,e),this.participantId=void 0,this.timeStamp=void 0,this.isVideoOn=void 0,this.participantId=t,this.isVideoOn=n,this.timeStamp=Date.now()}return Object(fe.a)(e,[{key:"process",value:function(e){e.isVideoOn=this.isVideoOn}}]),e}(),Ee=function e(t,n,a,r){Object(ge.a)(this,e),this.isVideoOn=void 0,this.isUnMuted=void 0,this.lastUnMuted=void 0,this.participantId=void 0,this.displayName=void 0,this.participantId=t,this.displayName=n,this.isUnMuted=a,this.isVideoOn=r,this.lastUnMuted=-1},Se=function e(t,n){var a=this;Object(ge.a)(this,e),this.dominantParticipantsCount=void 0,this.dipatch=void 0,this.batchedCommands=void 0,this.remoteParticipants=void 0,this.compareFn=function(e,t){return e.isVideoOn===t.isVideoOn?e.isUnMuted===t.isUnMuted?t.lastUnMuted-e.lastUnMuted:e.isUnMuted?-1:1:e.isVideoOn?-1:1},this.processCommands=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.batchedCommands;e.forEach((function(e){var t=a.remoteParticipants.get(e.participantId);t?e.process(t):console.error("RemoteStreamSelector: Participant ".concat(e.participantId," not found"))})),a.batchedCommands=[];var t=Object(U.a)(a.remoteParticipants.values()).sort(a.compareFn);console.log("RemoteStreamSelector: Participants sorted list",t),a.dipatch(ee(t.slice(0,a.dominantParticipantsCount)))},this.participantAudioChanged=function(e,t){a.batchedCommands.push(new ve(e,t))},this.participantVideoChanged=function(e,t){a.batchedCommands.push(new be(e,t))},this.participantStateChanged=function(e,t,n,r,i){switch(n){case"Connecting":a.remoteParticipants.set(e,new Ee(e,t,r,i));break;case"Connected":a.remoteParticipants.set(e,new Ee(e,t,r,i)),a.participantAudioChanged(e,r),a.participantVideoChanged(e,i);break;case"Disconnected":a.remoteParticipants.delete(e),a.processCommands()}},this.dominantParticipantsCount=t,this.dipatch=n,this.batchedCommands=[],this.remoteParticipants=new Map,setInterval((function(){return a.batchedCommands.length>0&&a.processCommands()}),e.ProcessingDelayInSeconds)};Se.ProcessingDelayInSeconds=2e3,Se.Singleton=void 0,Se.getInstance=function(e,t){var n;return Se.Singleton=null!==(n=Se.Singleton)&&void 0!==n?n:new Se(e,t)};var Oe=function e(){Object(ge.a)(this,e)};Oe.INCOMING="Incoming",Oe.RINGING="Ringing",Oe.CONNECTING="Connecting",Oe.CONNECTED="Connected",Oe.LOBBY="InLobby",Oe.DEFAULT_IMG_WIDTH=200,Oe.CROP_MEDIA="Crop",Oe.CONFIGURATION_LOCAL_VIDEO_PREVIEW_ID="ConfigurationLocalVideoPreview",Oe.LOCAL_VIDEO_PREVIEW_ID="LocalVideoPreview",Oe.MINI_HEADER_WINDOW_WIDTH=680,Oe.DOMINANT_PARTICIPANTS_COUNT=1;var Ie,Ce=function(e){return function(){var t=Object(d.a)(l.a.mark((function t(n,a){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(r=a())&&void 0!==r.calls.call){t.next=4;break}return console.error("state or state.controls.mic is null"),t.abrupt("return");case 4:if(t.prev=4,r.controls.mic){t.next=10;break}return t.next=8,r.calls.call.unmute();case 8:t.next=12;break;case 10:return t.next=12,r.calls.call.mute();case 12:n(te(e)),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(4),console.error(t.t0);case 18:case"end":return t.stop()}}),t,null,[[4,15]])})));return function(e,n){return t.apply(this,arguments)}}()},je=function(e,t,n){var a=Se.getInstance(Oe.DOMINANT_PARTICIPANTS_COUNT,n);e.on("stateChanged",(function(){var r;a.participantStateChanged(K.getId(e.identifier),null!==(r=e.displayName)&&void 0!==r?r:"",e.state,!e.isMuted,e.videoStreams[0].isAvailable),n(Q(Object(U.a)(t.remoteParticipants.values())))})),e.on("isMutedChanged",(function(){a.participantAudioChanged(K.getId(e.identifier),!e.isMuted)})),e.on("isSpeakingChanged",(function(){n(Q(Object(U.a)(t.remoteParticipants.values())))})),e.on("videoStreamsUpdated",(function(r){r.added.forEach((function(t){"ScreenSharing"===t.mediaStreamType?(t.on("isAvailableChanged",(function(){t.isAvailable?n(pe(t,e)):n({type:"REMOVE_SCREENSHARE_STREAM",stream:t,user:e})})),t.isAvailable&&n(pe(t,e))):"Video"===t.mediaStreamType&&t.on("isAvailableChanged",(function(){a.participantVideoChanged(K.getId(e.identifier),t.isAvailable)}))})),n(Q(Object(U.a)(t.remoteParticipants.values())))}))},we=function(){var e=Object(d.a)(l.a.mark((function e(t,n,a){var r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getMicrophones();case 2:r=e.sent,n(se(r)),void 0===(i=a()).devices.audioDeviceInfo&&r.length>0?(n(ce(r[0])),t.selectMicrophone(r[0])):i.devices.audioDeviceInfo&&!K.isSelectedAudioDeviceInList(i.devices.audioDeviceInfo,r)&&t.selectMicrophone(i.devices.audioDeviceInfo);case 6:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),ye=function(){var e=Object(d.a)(l.a.mark((function e(t,n,a){var r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getCameras();case 2:r=e.sent,n(le(r)),void 0===(i=a()).devices.videoDeviceInfo?n(oe(r[0])):i.devices.videoDeviceInfo&&!K.isSelectedVideoDeviceInList(i.devices.videoDeviceInfo,r)&&n(oe(i.devices.videoDeviceInfo));case 6:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),xe=function(){var e=Object(d.a)(l.a.mark((function e(t,n,a){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.on("videoDevicesUpdated",Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ye(t,n,a);case 1:case"end":return e.stop()}}),e)})))),t.on("audioDevicesUpdated",Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:we(t,n,a);case 1:case"end":return e.stop()}}),e)})))),t.askDevicePermission({audio:!0,video:!0}).then((function(e){void 0!==e.audio&&(e.audio?(n(re("Granted")),we(t,n,a)):n(re("Denied"))),void 0!==e.video&&(e.video?(n(ie("Granted")),ye(t,n,a)):n(ie("Denied")))}));case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),ke=function(){var e=Object(d.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.hangUp(n).catch((function(e){return console.error(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),De=function(){var e=Object(d.a)(l.a.mark((function e(t,n,a){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.join(n,a);case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),console.log("Failed to join a call",e.t0),e.abrupt("return");case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,n,a){return e.apply(this,arguments)}}(),Re=function(){var e=Object(d.a)(l.a.mark((function e(t,n,a){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.join(n,a);case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),console.log("Failed to join a call",e.t0),e.abrupt("return");case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,n,a){return e.apply(this,arguments)}}(),Ne=function(){var e=Object(d.a)(l.a.mark((function e(t,n,a){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return function(e){return!0},e.abrupt("return",De(t,n,a));case 5:return e.abrupt("return",Re(t,n,a));case 6:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),Ae=function(){var e=Object(d.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.removeParticipant(n).catch((function(e){return console.error(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Pe=n(565),Te=n(8),_e=n(256),Le=n(591),Fe=n(582),Ve={root:{minWidth:0,padding:"0 0.25rem",alignSelf:"stretch",height:"auto",width:"12.5rem"},primaryText:{color:"#000000"}},Me={root:{minWidth:0,padding:"0 0.25rem",alignSelf:"stretch",height:"auto"}},ze=Object(x.F)({maxHeight:"100%",overflow:"auto",paddingLeft:"1.125rem",paddingRight:"1.125rem"}),We=Object(x.F)({margin:"0.4375rem",fontSize:"1rem"}),Be={childrenGap:"0.625rem",padding:"0.625rem"},Ue=function(e){return a.createElement(a.Fragment,null,a.createElement(Pe.a,{text:e.name,styles:Ve,size:Te.c.size32,presence:"Connected"===e.state?Te.b.online:Te.b.offline}),e.isSpeaking?a.createElement(I.a,{size:"medium"}):a.createElement(C.a,{size:"medium"}),e.isScreenSharing&&a.createElement(_e.a,{className:We,iconName:"ScreenCast"}))},He=function(e){return a.createElement(Le.a,{role:"menuitem",title:"More options",styles:Me,menuIconProps:{iconName:"More"},menuProps:{items:e}})},Ge=Object(u.b)((function(e){var t;return{userId:e.sdk.userId,displayName:null===(t=e.calls.callAgent)||void 0===t?void 0:t.displayName,call:e.calls.call,callState:e.calls.callState,remoteParticipants:e.calls.remoteParticipants,screenShareStreams:e.streams.screenShareStreams,removeParticipant:function(t){e.calls.call&&t&&Ae(e.calls.call,t)}}}))((function(e){var t=e.screenShareStreams&&1===e.screenShareStreams.length,n=e.screenShareStreams[0],r=e.remoteParticipants.map((function(e){var a,r=!!t&&n.user===e;return{key:K.getId(e.identifier),name:null!==(a=e.displayName)&&void 0!==a?a:K.getId(e.identifier),participant:e,state:e.state,isScreenSharing:r,isSpeaking:e.isSpeaking}}));return r.push({key:"".concat(e.userId," (You)"),name:"".concat(e.displayName," (You)"),participant:void 0,state:"Connected",isScreenSharing:!!t&&K.getId(n.user.identifier)===e.userId,isSpeaking:!e.call.isMuted}),a.createElement(m.a,{className:ze,tokens:Be},function(e,t){return e.map((function(e,t){return a.createElement(Fe.a,{key:t,items:[e],role:"menubar",vertical:!1,onRenderOverflowButton:He,onRenderItem:Ue})}))}(r,e.removeParticipant))})),Ke=Object(x.A)().palette,Ye={root:{height:"100%",overflowY:"auto"}},Je={root:{marginBottom:"1.25rem"}},qe={childrenGap:"0.3125rem"},Xe={field:{color:Ke.neutralSecondary,padding:0},root:{marginLeft:"1rem",marginRight:"1rem"},fieldGroup:{border:"none"}},Qe=Object(x.F)({height:"4.3125rem"}),Ze=Object(x.F)({fontSize:"1.375rem",fontWeight:600,width:"69px",float:"left",margin:"20px"}),$e=Object(x.F)({fontWeight:600,fontSize:"1rem",marginLeft:"1rem",marginRight:"1rem"}),et=Object(x.F)({fontWeight:600,fontSize:"0.875rem",height:"2.5rem",marginLeft:"1rem",marginRight:"1rem",width:"90%"}),tt=Object(x.F)({marginRight:"0.5em"}),nt=Object(x.F)({marginLeft:"1.25rem",width:"15.375rem"}),at=n(575),rt=n(555),it=n(578),ct=function(){document.getElementById("inputText").select(),document.execCommand("copy")},ot=function(){return r.a.createElement(m.a,{styles:Je,tokens:qe},r.a.createElement(g.a,null),r.a.createElement("div",{className:$e},"Invite people to join"),r.a.createElement(at.a,{styles:Xe,id:"inputText",type:"text",value:"".concat(document.baseURI)}),r.a.createElement(rt.a,{className:et,onClick:ct},r.a.createElement(it.a,{iconName:"Copy",className:tt}),"Copy join info"))};!function(e){e.None="none",e.People="People",e.Settings="Settings"}(Ie||(Ie={}));var st,lt=function(e){return r.a.createElement(m.a,{styles:Ye},r.a.createElement(m.a.Item,{className:Qe},r.a.createElement("div",{className:Ze},e.selectedPane)),e.selectedPane===Ie.People&&r.a.createElement(m.a.Item,{styles:Ye},r.a.createElement(Ge,null)),e.selectedPane===Ie.People&&r.a.createElement(m.a.Item,null,r.a.createElement(ot,null)),e.selectedPane===Ie.Settings&&r.a.createElement(m.a.Item,null,r.a.createElement("div",{className:nt},r.a.createElement(B,{videoDeviceList:e.videoDeviceList,audioDeviceList:e.audioDeviceList,audioDeviceInfo:e.audioDeviceInfo,videoDeviceInfo:e.videoDeviceInfo,setVideoDeviceInfo:e.setVideoDeviceInfo,setAudioDeviceInfo:e.setAudioDeviceInfo,deviceManager:e.deviceManager}))))},dt=n(559),ut=n(560),mt=Object(x.A)().palette,pt={linkIsSelected:{padding:0,marginRight:0,height:"100%",color:mt.themePrimary,selectors:{":hover":{color:mt.themePrimary}}},link:{padding:0,marginRight:0,height:"3.75rem"},root:{width:"5.25rem",height:"3.75rem",display:"inline-block",verticalAlign:"top"}},ht=(Object(x.F)({display:"inline-block"}),Object(x.F)({width:"100%",height:"3.875rem",padding:"0.0625rem 0",boxShadow:"rgba(0, 0, 0, 0.133) 0px 1.6px 3.6px 0px, rgba(0, 0, 0, 0.11) 0px 0.3px 0.9px 0px",overflow:"hidden",flexDirection:"row",justifyContent:"flex-end",alignItems:"center",marginBottom:2})),gt=Object(x.F)(ht,{justifyContent:"center"}),ft=Object(x.F)({marginLeft:"1rem"}),vt=Object(x.F)({pointerEvents:"none",i:{color:"red"}}),bt=Object(x.F)({display:"inline-block",padding:"0 1rem",height:"1.875rem"}),Et=Object(x.F)({display:"inline-flex",height:"1.875rem"}),St=Object(x.F)({padding:"0 0.8125rem"}),Ot={root:{color:mt.neutralLight,width:"0.0625rem"}},It=n(571),Ct=n(556),jt=n(564),wt=Object(x.A)().palette,yt=Object(x.F)({color:wt.neutralSecondary,selectors:{":hover":{color:wt.blue}}}),xt=Object(x.F)({paddingLeft:"0.8125rem"}),kt=(Object(x.F)({color:"red",selectors:{":hover":{color:"red"}}}),Object(x.F)({position:"absolute",left:"10px",top:"16px"}),Object(x.F)({position:"relative",left:"10px",bottom:"5px",fontSize:"90%"}),Object(u.b)((function(e){return{conversationId:e.calls.serverCallId,recordingStatus:e.calls.recordingStatus}}),(function(e,t){return{startRecording:function(){return e(function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(a=n()).calls||!a.calls.serverCallId){e.next=8;break}return e.next=4,K.startRecording(a.calls.serverCallId);case 4:(r=e.sent)&&!r.message?t({type:"START_RECORDING",status:"STARTED"}):(t({type:"RECORDING_ERROR",recordingError:r.message}),console.error(r.message)),e.next=10;break;case 8:return console.error("serverCallId not available"),e.abrupt("return");case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())},stopRecording:function(){return e(function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(a=n()).calls||!a.calls.serverCallId){e.next=8;break}return e.next=4,K.stopRecording(a.calls.serverCallId);case 4:(r=e.sent)&&!r.message?t({type:"STOP_RECORDING",status:"STOPPED"}):console.error(r.message),e.next=9;break;case 8:return e.abrupt("return");case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}}}))((function(e){var t=r.a.useRef(null),n=r.a.useState(!1),a=Object(o.a)(n,2),i=a[0],c=a[1],s=r.a.useCallback((function(e){e.preventDefault(),c(!0)}),[]),l=r.a.useCallback((function(){return c(!1)}),[]),d=["startRecording","stopRecording"],u={props:e},m=r.a.useCallback((function(t,n){"startRecording"===(null===n||void 0===n?void 0:n.key)?e.startRecording():e.stopRecording()}),[u]),p=r.a.useMemo((function(){return{items:[{key:d[0],iconProps:{iconName:"CircleFill",style:{color:"crimson"}},text:"Start recording",disabled:"STARTED"===e.recordingStatus,onClick:m},{key:d[1],iconProps:{iconName:"CircleStopSolid",style:{color:"indianred"}},text:"Stop recording",disabled:"STOPPED"===e.recordingStatus,onClick:m}]}}),[e.recordingStatus,m,d]);return r.a.createElement("div",null,r.a.createElement("a",{ref:t,className:yt,onClick:s,href:"#"},r.a.createElement("div",{className:_},r.a.createElement(It.a,{content:"More actions",id:"moreActions",calloutProps:{gapSpace:0},styles:{root:{display:"inline-block"}}},r.a.createElement(Ct.a,{"aria-describedby":"moreActions",size:"medium",className:xt})))),r.a.createElement(jt.a,{items:p.items,hidden:!i,target:t,onItemClick:l,onDismiss:l,gapSpace:10}))}))),Dt=n(96),Rt=n(580),Nt=n(569),At=n(286),Pt=n(285),Tt=n(566),_t=function(e){return new Promise((function(t){e.toBlob((function(e){t(e)}),"image/png")}))},Lt=function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a,r,i,c,o,s,d,u,m;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,K.getFeedbackSettings();case 3:if(a=e.sent,r=new Tt.a(a.sasUri),i=r.getContainerClient(a.containerName),c=i.getBlockBlobClient("logs-".concat(t.feedbackId,".json")),o=JSON.stringify(t,null,4),s=c.upload(o,o.length),d=void 0,!n){e.next=16;break}return u=i.getBlockBlobClient("screenShot-".concat(t.feedbackId,".png")),e.next=14,_t(n);case 14:null!=(m=e.sent)&&(d=u.uploadData(m));case 16:return e.next=18,Promise.all([s,d]);case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(0),console.log(e.t0);case 23:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(t,n){return e.apply(this,arguments)}}(),Ft=function(){var e=Object(d.a)(l.a.mark((function e(){var t,n,a,r,i,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.createElement("canvas"),n=t.getContext("2d"),e.next=4,navigator.mediaDevices.getDisplayMedia({video:!0});case 4:return a=e.sent,r=a.getVideoTracks()[0],i=new ImageCapture(r),e.next=9,i.grabFrame();case 9:return c=e.sent,t.width=c.width,t.height=c.height,r.stop(),null===n||void 0===n||n.drawImage(c,0,0,c.width,c.height),a.getTracks().forEach((function(e){return e.stop()})),e.abrupt("return",t);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Vt=function(){var e,t,n;return!!(null===(e=null===(t=window)||void 0===t||null===(n=t.navigator)||void 0===n?void 0:n.mediaDevices)||void 0===e?void 0:e.getDisplayMedia)&&!!window.ImageCapture},Mt=n(90),zt=n(273),Wt={deviceManager:void 0,audioDeviceInfo:void 0,videoDeviceInfo:void 0,audioDeviceList:[],videoDeviceList:[],cameraPermission:void 0,microphonePermission:void 0},Bt={localVideoRendererIsBusy:!1,localVideoStream:void 0,screenShareStreams:[]},Ut={mic:!1,localVideo:!1,shareScreen:!1},Ht={displayName:""},Gt={callAgent:void 0,call:void 0,callState:"None",incomingCallEndReason:void 0,callEndReason:void 0,remoteParticipants:[],attempts:0,isBeingRecorded:void 0,isBeingTranscribed:void 0,dominantParticipants:[],serverCallId:"",recordingStatus:"STOPPED",dialogBoxVisible:!1,recordingError:""},Kt=Object(Mt.c)({calls:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Gt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CALL_AGENT":return Object(G.a)(Object(G.a)({},e),{},{callAgent:t.callAgent});case"CALL_ADDED":return Object(G.a)(Object(G.a)({},e),{},{call:t.call});case"CALL_REMOVED":return Object(G.a)(Object(G.a)({},e),{},{call:void 0,remoteParticipants:[],incomingCallEndReason:t.incomingCallEndReason,callEndReason:t.callEndReason,serverCallId:"",recordingStatus:"STOPPED"});case"SET_CALL_STATE":return Object(G.a)(Object(G.a)({},e),{},{callState:t.callState});case"SET_DOMINANT_PARTICIPANTS":return Object(G.a)(Object(G.a)({},e),{},{dominantParticipants:t.dominantParticipants});case"SET_PARTICIPANTS":return Object(G.a)(Object(G.a)({},e),{},{remoteParticipants:t.remoteParticipants});case"SET_RECORDING_ACTIVE":return Object(G.a)(Object(G.a)({},e),{},{isBeingRecorded:t.active});case"SET_TRANSCRIBING_ACTIVE":return Object(G.a)(Object(G.a)({},e),{},{isBeingTranscribed:t.active});case"START_RECORDING":case"STOP_RECORDING":return Object(G.a)(Object(G.a)({},e),{},{recordingStatus:t.status});case"SET_SERVER_CALL_ID":return Object(G.a)(Object(G.a)({},e),{},{serverCallId:t.serverCallId});case"DIALOGBOX_VISIBLE":return Object(G.a)(Object(G.a)({},e),{},{dialogBoxVisible:t.dialogBoxVisible});case"RECORDING_ERROR":return Object(G.a)(Object(G.a)({},e),{},{recordingError:t.recordingError,dialogBoxVisible:!0});default:return e}},devices:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DEVICE_MANAGER":return Object(G.a)(Object(G.a)({},e),{},{deviceManager:t.deviceManager});case"SET_VIDEO_DEVICE_INFO":return Object(G.a)(Object(G.a)({},e),{},{videoDeviceInfo:t.videoDeviceInfo});case"SET_AUDIO_DEVICE_INFO":return Object(G.a)(Object(G.a)({},e),{},{audioDeviceInfo:t.audioDeviceInfo});case"SET_VIDEO_DEVICE_LIST":return Object(G.a)(Object(G.a)({},e),{},{videoDeviceList:t.videoDeviceList});case"SET_AUDIO_DEVICE_LIST":return Object(G.a)(Object(G.a)({},e),{},{audioDeviceList:t.audioDeviceList});case"SET_CAMERA_PERMISSION":return Object(G.a)(Object(G.a)({},e),{},{cameraPermission:t.cameraPermission});case"SET_MICROPHONE_PERMISSION":return Object(G.a)(Object(G.a)({},e),{},{microphonePermission:t.microphonePermission});default:return e}},streams:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_VIDEO_DEVICE_INFO":return e.localVideoStream&&t.videoDeviceInfo?Object(G.a)(Object(G.a)({},e),{},{localVideoStream:new E.LocalVideoStream(t.videoDeviceInfo)}):e;case"SET_LOCAL_STREAM":return Object(G.a)(Object(G.a)({},e),{},{localVideoStream:t.localVideoStream});case"ADD_SCREENSHARE_STREAM":var n={stream:t.stream,user:t.user};return Object(G.a)(Object(G.a)({},e),{},{screenShareStreams:[].concat(Object(U.a)(e.screenShareStreams),[n])});case"REMOVE_SCREENSHARE_STREAM":var a=e.screenShareStreams.filter((function(e){return e.stream!==t.stream&&e.user!==t.user}));return Object(G.a)(Object(G.a)({},e),{},{screenShareStreams:a});default:return e}},controls:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ut,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_MIC":return Object(G.a)(Object(G.a)({},e),{},{mic:t.mic});case"SET_SHARE_SCREEN":return Object(G.a)(Object(G.a)({},e),{},{shareScreen:t.shareScreen});default:return e}},sdk:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ht,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USERID":return Object(G.a)(Object(G.a)({},e),{},{userId:t.userId});case"SET_CALL_CLIENT":return Object(G.a)(Object(G.a)({},e),{},{callClient:t.callClient});case"SET_DISPLAY_NAME":return Object(G.a)(Object(G.a)({},e),{},{displayName:t.displayName});default:return e}}}),Yt=Object(Mt.d)(Kt,Object(Mt.a)(zt.a)),Jt=[],qt=n(558),Xt=function(e,t){var n,a,r=null!==(n=null===(a=Yt.getState().calls.call)||void 0===a?void 0:a.id)&&void 0!==n?n:"Not Found";return{logs:Jt,callId:r,comments:t,feedbackId:Object(qt.a)(),type:e}},Qt=function(e){var t=e.iconOnly,n=Object(a.useState)(!0),i=Object(o.a)(n,2),c=i[0],s=i[1],l=Object(a.useCallback)((function(){s(!c)}),[c]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,{key:"Feedback",text:t?void 0:"Report a bug",ariaLabel:t?"Report a bug":void 0,iconProps:{iconName:"Feedback"},onClick:l}),!c&&r.a.createElement(nn,{toggleHidden:l}))},Zt=[{key:"Calling - Audio",text:"Calling - Audio"},{key:"Calling - Call drops",text:"Calling - Call drops"},{key:"Calling - Other",text:"Calling - Other"},{key:"Calling - Video",text:"Calling - Video"},{key:"Calling - Screen sharing",text:"Calling - Screen sharing"},{key:"Participants list",text:"Participants list"},{key:"Join experience",text:"Join experience"},{key:"App Crashing",text:"App Crashing"},{key:"Others",text:"Others"}],$t={isBlocking:!1,styles:{main:{maxWidth:650,minWidth:450}}},en={width:"16.75rem",objectFit:"cover"},tn={type:Dt.a.largeHeader,title:"Feedback",subText:"Something went wrong? Please provide feedback here!"},nn=function(e){var t=Object(a.useState)(""),n=Object(o.a)(t,2),i=n[0],c=n[1],s=Object(a.useState)(""),u=Object(o.a)(s,2),m=u[0],h=u[1],g=Object(a.useState)(""),f=Object(o.a)(g,2),v=f[0],b=f[1],E=Object(a.useState)(!1),S=Object(o.a)(E,2),O=S[0],I=S[1],C=Object(a.useState)(),j=Object(o.a)(C,2),w=j[0],y=j[1],x=Object(a.useState)(!1),k=Object(o.a)(x,2),D=k[0],R=k[1],N=Object(a.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ft();case 2:t=e.sent,y(t);case 4:case"end":return e.stop()}}),e)}))),[]),A=Object(a.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Xt(i,m),e.next=3,Lt(t,w);case 3:b(t.feedbackId);case 4:case"end":return e.stop()}}),e)}))),[i,m,w]),P=r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,null,"What is this related to? (Required)"),r.a.createElement(F.a,{defaultSelectedKey:"Calling - Audio",options:Zt,onChange:function(e,t){c(null===t||void 0===t?void 0:t.key)}}),r.a.createElement(p.a,null,"What are you seeing? Has it always been that way? Any step to repro?"),r.a.createElement(at.a,{onChange:function(e,t){h(null!==t&&void 0!==t?t:"")},value:m,multiline:!0,rows:6}),r.a.createElement(Rt.a,{label:"Include screen shot",checked:!!w,onChange:function(e,t){return t?I(null!==t&&void 0!==t&&t):y(void 0)}}),O&&r.a.createElement(rn,{onDismiss:function(){I(!1)},onTakeScreenShot:N,setIsParentHidden:R}),w&&r.a.createElement("img",{src:null===w||void 0===w?void 0:w.toDataURL(),style:en,alt:"screen shot"})),T=r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,null,"Please provide this guid to developers for targeting the case:"),r.a.createElement(at.a,{value:v,readOnly:!0}));return r.a.createElement(Nt.a,{dialogContentProps:tn,modalProps:$t,hidden:D,onDismiss:e.toggleHidden},!v&&P,v&&T,r.a.createElement(At.a,null,!v&&r.a.createElement(rt.a,{onClick:A,text:"Send"}),r.a.createElement(Pt.a,{onClick:e.toggleHidden,text:"Close"})))},an={type:Dt.a.largeHeader,title:"Take a screen shot",subText:Vt()?"Ready to take a screen shot? Please click [Microsoft Edge tab]/[Chrome tab] in next popup and choose the current tab!":"Sorry, screen shot is not available for your browser."},rn=function(e){var t=e.onTakeScreenShot,n=e.onDismiss,i=e.setIsParentHidden,c=Object(a.useState)(!1),s=Object(o.a)(c,2),u=s[0],m=s[1],p=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),m(!0),e.prev=2,e.next=5,t();case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:i(!1),n();case 11:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(Nt.a,{dialogContentProps:an,modalProps:$t,hidden:u,onDismiss:n},r.a.createElement(At.a,null,Vt()&&r.a.createElement(rt.a,{onClick:p,text:"I am ready!"}),r.a.createElement(Pt.a,{onClick:n,text:"Never mind"})))},cn=Object(u.b)((function(e,t){return{actionable:e.calls.callState===Oe.INCOMING||e.calls.callState===Oe.RINGING||e.calls.callState===Oe.CONNECTING||e.calls.callState===Oe.CONNECTED,localVideoStream:e.streams.localVideoStream,mic:e.controls.mic,call:e.calls.call,shareScreen:e.controls.shareScreen,endCall:function(){e.calls.call&&ke(e.calls.call,{forEveryone:!1}),t.endCallHandler()},videoDeviceInfo:e.devices.videoDeviceInfo,screenWidth:t.screenWidth,screenShareStreams:e.streams.screenShareStreams,localVideoRendererIsBusy:e.streams.localVideoRendererIsBusy,cameraPermission:e.devices.cameraPermission,microphonePermission:e.devices.microphonePermission,recordingStatus:e.calls.recordingStatus}}),(function(e){return{setLocalVideoStream:function(t){return e(me(t))},setMic:function(t){return e(Ce(t))},setScreenShare:function(t){return e((n=t,function(){var e=Object(d.a)(l.a.mark((function e(t,a){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(r=a())&&void 0!==r.calls.call){e.next=4;break}return console.error("state or state.controls.shareScreen is null"),e.abrupt("return");case 4:if(e.prev=4,r.controls.shareScreen){e.next=10;break}return e.next=8,r.calls.call.startScreenSharing();case 8:e.next=12;break;case 10:return e.next=12,r.calls.call.stopScreenSharing();case 12:t(ne(n)),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(4),console.error(e.t0);case 18:case"end":return e.stop()}}),e,null,[[4,15]])})));return function(t,n){return e.apply(this,arguments)}}()));var n},isLocalScreenShareSupportedInBrowser:function(){return!K.isMobileSession()&&(/chrome/i.test(navigator.userAgent.toLowerCase())||/safari/i.test(navigator.userAgent.toLowerCase()))}}}))((function(e){var t,n=Object(a.useState)(!1),i=Object(o.a)(n,2),c=i[0],s=i[1],u=Object(a.useState)(!1),p=Object(o.a)(u,2),h=p[0],S=p[1],O=e.screenWidth<=Oe.MINI_HEADER_WINDOW_WIDTH,I="STARTED"===e.recordingStatus;Object(a.useEffect)((function(){Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.getFeedbackSettings();case 2:return t=e.sent,s(t.isFeedbackEnabled),e.next=6,K.getRecordingSettings();case 6:n=e.sent,S(n.isRecordingEnabled);case 8:case"end":return e.stop()}}),e)})))()}),[]);var C=function(){var t=Object(d.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.localVideoStream){t.next=6;break}return t.next=3,e.call.stopVideo(e.localVideoStream);case 3:e.setLocalVideoStream(void 0),t.next=11;break;case 6:if(!e.videoDeviceInfo){t.next=11;break}return n=new E.LocalVideoStream(e.videoDeviceInfo),e.setLocalVideoStream(n),t.next=11,e.call.startVideo(n);case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(a.useEffect)((function(){e.call&&0===e.call.localVideoStreams.length&&e.localVideoStream&&e.call.startVideo(e.localVideoStream)}),[e.call,e.localVideoStream]),r.a.createElement(m.a,{id:"header",className:e.screenWidth>Oe.MINI_HEADER_WINDOW_WIDTH?ht:gt},r.a.createElement(m.a.Item,{grow:1,className:ft},c&&r.a.createElement(Qt,{iconOnly:O}),c&&I&&r.a.createElement("div",{className:Et},r.a.createElement(g.a,{styles:Ot,vertical:!0})),I&&r.a.createElement(f.a,{className:vt,key:"RadioBtnOn",text:O?void 0:"Recording",ariaLabel:O?"Recording":void 0,iconProps:{iconName:"RadioBtnOn"}})),r.a.createElement(v.a,{onKeyDownCapture:function(e){e.target.id===Ie.People&&39===e.keyCode&&e.preventDefault()},getTabId:function(e){return e},onLinkClick:function(t){var n,a;t&&(t.props.itemKey===Ie.Settings&&(n=e.selectedPane,a=e.setSelectedPane,n!==Ie.Settings?a(Ie.Settings):a(Ie.None)),t.props.itemKey===Ie.People&&function(e,t){e!==Ie.People?t(Ie.People):t(Ie.None)}(e.selectedPane,e.setSelectedPane))},styles:pt,initialSelectedKey:Ie.None,selectedKey:e.selectedPane},r.a.createElement(b.a,{itemKey:Ie.Settings,onRenderItemLink:function(){return r.a.createElement(dt.a,{outline:e.selectedPane!==Ie.Settings,size:"medium",className:St})}}),r.a.createElement(b.a,{itemKey:Ie.People,onRenderItemLink:function(){return r.a.createElement(ut.a,{outline:e.selectedPane!==Ie.People,size:"medium",className:St})}}),r.a.createElement(b.a,{itemKey:Ie.None})),h&&r.a.createElement(m.a,null,r.a.createElement(kt,null)),e.screenWidth>Oe.MINI_HEADER_WINDOW_WIDTH&&r.a.createElement("div",{className:bt},r.a.createElement(g.a,{styles:Ot,vertical:!0})),r.a.createElement(L,{micActive:e.mic,onMicChange:function(){e.setMic(!e.mic)},cameraActive:void 0!==e.localVideoStream,onCameraChange:C,screenShareActive:e.shareScreen,activeScreenShareStream:null!==(t=e.screenShareStreams[0])&&void 0!==t?t:void 0,onScreenShareChange:function(){e.setScreenShare(!e.shareScreen)},onEndCallClick:function(){e.localVideo&&C(),e.endCall()},cameraPermission:e.cameraPermission,microphonePermission:e.microphonePermission,localVideoRendererIsBusy:e.localVideoRendererIsBusy,compressedMode:O,isLocalScreenShareSupportedInBrowser:e.isLocalScreenShareSupportedInBrowser}))})),on=Object(x.A)().palette,sn=Object(x.F)({padding:"0.4375rem",display:"flex",alignItems:"center",justifyContent:"center",border:0,borderRight:"1px solid rgba(0,0,0,0.05)",borderBottom:"1px solid rgba(0,0,0,0.05)"}),ln=Object(x.F)({height:"100%",background:on.neutralLighterAlt,display:"grid",overflow:"hidden"}),dn=Object(x.F)({padding:"0.4375rem",width:"100px",minWidth:"100px",height:"100px",display:"flex",alignItems:"center",justifyContent:"center",border:0,borderRight:"1px solid rgba(0,0,0,0.05)",borderBottom:"1px solid rgba(0,0,0,0.05)"}),un=Object(x.F)({height:"8.438rem",overflowX:"auto",overflowY:"hidden"}),mn=n(31),pn=n(150),hn=Object(x.A)().palette,gn=Object(x.F)({backgroundColor:hn.neutralSecondary,bottom:"5%",height:"1.75rem",boxShadow:"0 0 1px 0 rgba(0,0,0,.16)",color:hn.neutralLighter,fontSize:"1.25rem",lineHeight:"1.0625rem",textAlign:"left",left:"2%",overflow:"hidden",position:"absolute",padding:"0.25rem",whiteSpace:"nowrap",maxWidth:"95%",borderRadius:4,textOverflow:"ellipsis"}),fn=Object(x.F)({position:"relative",height:"100%",width:"100%",background:"transparent"}),vn=Object(x.F)(fn,{width:"100%",height:"100%"}),bn=n(92),En=n.n(bn),Sn=function(e){var t=Object(a.useRef)(),n=Object(a.useState)(!1),i=Object(o.a)(n,2),c=i[0],s=i[1],u={src:En.a.toString(),imageFit:mn.b.contain,styles:{root:{width:"100%",height:"100%",display:c?"none":"block"}}},m=e.stream,h=e.label;return Object(a.useEffect)((function(){return Object(d.a)(l.a.mark((function e(){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!m){e.next=9;break}return n=new E.VideoStreamRenderer(m),e.next=4,n.createView({scalingMode:"Crop",isMirrored:!0});case 4:t.current=e.sent,(a=document.getElementById(Oe.LOCAL_VIDEO_PREVIEW_ID))&&0===a.childElementCount&&(a.appendChild(t.current.target),s(!0)),e.next=10;break;case 9:t.current&&(t.current.dispose(),s(!1));case 10:case"end":return e.stop()}}),e)})))(),function(){t.current&&(t.current.dispose(),t.current=void 0,s(!1))}}),[m]),r.a.createElement("div",{className:fn},r.a.createElement("div",{style:{display:c?"block":"none"},className:vn,id:Oe.LOCAL_VIDEO_PREVIEW_ID}),r.a.createElement(pn.a,u),r.a.createElement(p.a,{className:gn},h))},On=n(584),In=n(68),Cn=function(e){var t=Object(a.useRef)(),n=e.stream?K.getStreamId(e.label,e.stream):"".concat(e.label," - no stream"),i=Object(a.useState)(!1),c=Object(o.a)(i,2),s=c[0],u=c[1],m=Object(a.useState)(!1),h=Object(o.a)(m,2),g=h[0],f=h[1],v={src:En.a.toString(),imageFit:mn.b.contain,styles:{root:{width:"100%",height:"100%",display:s?"none":"block"}}},b=(En.a.toString(),mn.b.contain,e.label),S=e.stream,O=e.isParticipantStreamSelected,I=Object(a.useCallback)(Object(d.a)(l.a.mark((function e(){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((a=document.getElementById(n))&&S&&S.isAvailable&&O)){e.next=14;break}if(!s){e.next=4;break}return e.abrupt("return");case 4:return u(!0),f(!0),r=new E.VideoStreamRenderer(S),e.next=9,r.createView({scalingMode:"Crop"});case 9:t.current=e.sent,f(!1),a&&0===a.childElementCount&&a.appendChild(t.current.target),e.next=16;break;case 14:u(!1),t.current&&(t.current.dispose(),t.current=void 0);case 16:case"end":return e.stop()}}),e)}))),[S,O,f,u,s,t,n]);return Object(a.useEffect)((function(){S&&(S.on("isAvailableChanged",I),S.isAvailable&&I())}),[S,O,I]),r.a.createElement("div",{className:fn},r.a.createElement("div",{style:{display:s?"block":"none"},className:fn,id:n},g&&r.a.createElement(On.a,{style:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},label:"Rendering stream...",size:In.a.xSmall})),r.a.createElement(pn.a,v),r.a.createElement(p.a,{className:gn},b))},jn=Object(u.b)((function(e){var t;return{userId:e.sdk.userId,displayName:null===(t=e.calls.callAgent)||void 0===t?void 0:t.displayName,remoteParticipants:e.calls.remoteParticipants,dominantParticipants:e.calls.dominantParticipants,localVideoStream:e.streams.localVideoStream}}))((function(e){var t=Object(a.useState)(1),n=Object(o.a)(t,2),i=n[0],c=n[1],s=Object(a.useState)(1),l=Object(o.a)(s,2),d=l[0],u=l[1],p=[1,1,2,2,2,2,3,3,3,3],h=[1,2,2,2,3,3,3,3,3,4];(Oe.DOMINANT_PARTICIPANTS_COUNT<0||Oe.DOMINANT_PARTICIPANTS_COUNT>p.length)&&console.warn("Please use a value for dominant participants between 0 < x < ".concat(p.length));var g=Math.min(Oe.DOMINANT_PARTICIPANTS_COUNT,p.length-1),f=Object(a.useMemo)((function(){return t=e.remoteParticipants.length,n=0,a=g,Math.min(Math.max(t,n),a);var t,n,a}),[e.remoteParticipants.length]);if(h[f]!==i){if(f>h.length-1)throw"attempting to set up a number of columns in the gallery for an unexpected number of participants ".concat(f);c(h[f])}if(p[f]!==d){if(f>p.length-1)throw"attempting to set up a number of rows in the gallery for an expected unnumber of participants ".concat(f);u(p[f])}var v=e.remoteParticipants.sort((function(t,n){var a=e.dominantParticipants.filter((function(e){return e.participantId===K.getId(t.identifier)})).length>0,r=e.dominantParticipants.filter((function(e){return e.participantId===K.getId(n.identifier)})).length>0;return a&&!r?-1:!a&&r?1:0})),b=v.slice(0,g),E=v.slice(g),S=E.length>0;return r.a.createElement(m.a,{style:{height:"100%"}},r.a.createElement("div",{id:"video-gallery",className:ln,style:{gridTemplateRows:"repeat(".concat(d,", minmax(0, 1fr))"),gridTemplateColumns:"repeat(".concat(i,", 1fr)")}},function(t,n){var a=t.map((function(t){var n;return r.a.createElement("div",{key:"".concat(K.getId(t.identifier),"-tile"),className:sn},r.a.createElement(Cn,{key:K.getId(t.identifier),stream:t.videoStreams[0],isParticipantStreamSelected:e.dominantParticipants.filter((function(e){return e.participantId===K.getId(t.identifier)})).length>0,label:null!==(n=t.displayName)&&void 0!==n?n:K.getId(t.identifier)}))})),i=r.a.createElement("div",{key:"localParticipantTile",className:sn},r.a.createElement(Sn,{label:n,stream:e.localVideoStream}));return a.unshift(i),a}(b,e.displayName)),S&&r.a.createElement(m.a,{horizontal:!0,className:un},E.map((function(e){var t;return r.a.createElement("div",{key:"".concat(K.getId(e.identifier),"-tile"),className:dn},r.a.createElement(Cn,{key:K.getId(e.identifier),stream:e.videoStreams[0],isParticipantStreamSelected:!1,label:null!==(t=e.displayName)&&void 0!==t?t:K.getId(e.identifier)}))}))))})),wn=Object(x.A)().palette,yn=Object(x.F)({padding:"0.5em",borderRight:"1px solid rgba(0,0,0,0.05)",height:"100%",width:"100%",background:wn.neutralLighterAlt}),xn=Object(x.F)({display:"none",borderRight:"1px solid rgba(0,0,0,0.05)",height:"100%",width:"100%",background:wn.neutralLighterAlt}),kn=Object(x.F)({height:"100%",display:"flex",justifyContent:"center"}),Dn=function(e){var t,n=Object(a.useState)(!0),i=Object(o.a)(n,2),c=i[0],s=i[1],u=Object(a.useRef)(),m=e.activeScreenShareStream;Object(a.useEffect)((function(){Object(d.a)(l.a.mark((function e(){var t,n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!m||!m.stream){e.next=10;break}return t=m.stream,n=new E.VideoStreamRenderer(t),e.next=5,n.createView({scalingMode:"Fit"});case 5:u.current=e.sent,(a=document.getElementById("fullScreenStreamMediaId"))&&0===a.childElementCount&&(s(!1),a.appendChild(u.current.target)),e.next=11;break;case 10:u.current&&u.current.dispose();case 11:case"end":return e.stop()}}),e)})))()}),[m]);var p=null!==(t=e.activeScreenShareStream.user.displayName)&&void 0!==t?t:K.getId(e.activeScreenShareStream.user.identifier);return r.a.createElement(r.a.Fragment,null,c&&r.a.createElement("div",{className:kn},r.a.createElement(On.a,{label:"Loading ".concat(p,"'s screen"),size:In.a.xSmall})),r.a.createElement("div",{id:"fullScreenStreamMediaId",className:c?xn:yn}))},Rn=Object(x.A)().palette,Nn={root:{width:"100%"}},An={root:{height:"100%",minHeight:"9.375rem",width:"100%"}},Pn={root:{width:"100%"}},Tn={root:{width:"17.875rem"}},_n={root:{background:Rn.white,marginTop:"4rem"}},Ln={root:{border:"solid 1px ".concat(Rn.neutralLighterAlt),height:"100%",display:"none"}},Fn={root:{border:"solid 1px ".concat(Rn.neutralLighterAlt),height:"calc(100% - 3px)",display:"initial",width:"100%"}},Vn=Object(x.F)({height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}),Mn=n(585),zn=n(586),Wn=function(e){var t=Object(a.useState)(!1),n=Object(o.a)(t,2),i=n[0],c=n[1],s=Object(a.useState)(!1),l=Object(o.a)(s,2),d=l[0],u=l[1],m=Object(a.useState)(0),p=Object(o.a)(m,2),h=p[0],g=p[1],f=e.callTranscribeState,v=e.callRecordState;function b(){return r.a.createElement(Mn.a,{href:"https://privacy.microsoft.com/en-US/privacystatement#mainnoticetoendusersmodule",target:"_blank",underline:!0},"Privacy policy")}function E(){return r.a.createElement(Mn.a,{href:"https://support.microsoft.com/en-us/office/record-a-meeting-in-teams-34dfbe7f-b07d-4a27-b4c6-de62f1348c24",target:"_blank",underline:!0},"Learn more")}return Object(a.useEffect)((function(){d&&i?g(v&&!f?1:!v&&f?2:v||f?0:3):d&&!i?g(v&&f?4:!v&&f?5:v||f?0:6):!d&&i?g(v&&f?4:!v&&f?7:v||f?0:8):d||i||g(v&&f?4:v&&!f?7:!v&&f?5:0),c(f),u(v)}),[f,v]),0===h?r.a.createElement(r.a.Fragment,null):r.a.createElement(zn.a,{onDismiss:function(){g(0)},dismissButtonAriaLabel:"Close"},function(e){switch(e){case 1:return r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,"Transcription has stopped.")," You are now only recording this meeting.",r.a.createElement(b,null));case 2:return r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,"Recording has stopped.")," You are now only transcribing this meeting.",r.a.createElement(b,null));case 3:return r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,"Recording and transcription are being saved. ")," Recording and transcription have stopped.",r.a.createElement(E,null));case 4:return r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,"Recording and transcription have started.")," By joining, you are giving consent for this meeting to be transcribed.",r.a.createElement(b,null));case 5:return r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,"Transcription has started.")," By joining, you are giving consent for this meeting to be transcribed.",r.a.createElement(b,null));case 6:return r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,"Recording is being saved.")," Recording has stopped.",r.a.createElement(E,null));case 7:return r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,"Recording has started.")," By joining, you are giving consent for this meeting to be transcribed.",r.a.createElement(b,null));case 8:return r.a.createElement(r.a.Fragment,null,r.a.createElement("b",null,"Transcription is being saved.")," Transcription has stopped.",r.a.createElement(E,null))}return r.a.createElement(r.a.Fragment,null)}(h))},Bn=n(23),Un={main:{width:340}},Hn={type:Dt.a.normal,title:"Error !"},Gn=function(e){var t=r.a.useMemo((function(){return{isBlocking:!0,styles:Un}}),[]);return r.a.createElement(m.a,null,r.a.createElement(Nt.a,{hidden:!e.isDialogBoxVisiblile,onDismiss:e.dismissDialogBox,dialogContentProps:Hn,modalProps:t},r.a.createElement(zn.a,{messageBarType:Bn.a.error,dismissButtonAriaLabel:"Close"},e.message),r.a.createElement(At.a,{className:R},r.a.createElement(Pt.a,{text:"OK",onClick:e.dismissDialogBox}))))},Kn=Object(u.b)((function(e,t){return{userId:e.sdk.userId,callAgent:e.calls.callAgent,deviceManager:e.devices.deviceManager,screenWidth:t.screenWidth,call:e.calls.call,shareScreen:e.controls.shareScreen,mic:e.controls.mic,callEndReason:e.calls.callEndReason,join:function(){var t=Object(d.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.calls.callAgent,!t.t0){t.next=4;break}return t.next=4,Ne(e.calls.callAgent,n,{videoOptions:{localVideoStreams:e.streams.localVideoStream?[e.streams.localVideoStream]:void 0},audioOptions:{muted:!e.controls.mic}});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),remoteParticipants:e.calls.remoteParticipants,callState:e.calls.callState,localVideo:e.controls.localVideo,localVideoStream:e.streams.localVideoStream,screenShareStreams:e.streams.screenShareStreams,videoDeviceInfo:e.devices.videoDeviceInfo,audioDeviceInfo:e.devices.audioDeviceInfo,videoDeviceList:e.devices.videoDeviceList,audioDeviceList:e.devices.audioDeviceList,cameraPermission:e.devices.cameraPermission,microphonePermission:e.devices.microphonePermission,recordingStatus:e.calls.recordingStatus,recordingError:e.calls.recordingError,isDialogBoxVisiblile:e.calls.dialogBoxVisible,isBeingRecorded:e.calls.isBeingRecorded,isBeingTranscribed:e.calls.isBeingTranscribed}}),(function(e){return{mute:function(){return e(Ce(!1))},setAudioDeviceInfo:function(t){e(ce(t))},setVideoDeviceInfo:function(t){e(oe(t))},dialogBoxVisiblilty:function(t){return e({type:"DIALOGBOX_VISIBLE",dialogBoxVisible:t})},setLocalVideoStream:function(t){return e(me(t))}}}))((function(e){var t=Object(a.useState)(Ie.None),n=Object(o.a)(t,2),i=n[0],c=n[1],s=e.screenShareStreams&&1===e.screenShareStreams.length,l=e.callAgent,d=e.call,u=e.join,g=e.locator,f=e.isBeingRecorded,v=e.isBeingTranscribed,b=e.callEndReason;Object(a.useEffect)((function(){l&&!d&&void 0===b&&u(g)}),[l,d,u,g,b]);return r.a.createElement(m.a,{horizontalAlign:"center",verticalAlign:"center",styles:An},r.a.createElement(m.a.Item,{styles:Nn},r.a.createElement(cn,{selectedPane:i,setSelectedPane:c,endCallHandler:function(){e.endCallHandler()},screenWidth:e.screenWidth})),r.a.createElement(m.a.Item,{styles:Pn},r.a.createElement(Wn,{callTranscribeState:v,callRecordState:f})),r.a.createElement(m.a.Item,{styles:Nn},e.isDialogBoxVisiblile&&""!==e.recordingError&&r.a.createElement(Gn,{message:e.recordingError,isDialogBoxVisiblile:e.isDialogBoxVisiblile,dismissDialogBox:function(){e.dialogBoxVisiblilty(!1)}})),r.a.createElement(m.a.Item,{styles:An},e.shareScreen&&r.a.createElement("div",{className:Vn},r.a.createElement(p.a,null,"Your screen is being shared")),e.callState===Oe.CONNECTED&&r.a.createElement(m.a,{horizontal:!0,styles:An},r.a.createElement(m.a.Item,{grow:!0,styles:s?Fn:Ln},s&&r.a.createElement(Dn,{activeScreenShareStream:e.screenShareStreams[0]})),r.a.createElement(m.a.Item,{grow:!0,styles:s?Ln:Fn},r.a.createElement(jn,null)),i!==Ie.None&&(window.innerWidth>Oe.MINI_HEADER_WINDOW_WIDTH?r.a.createElement(m.a.Item,{disableShrink:!0,styles:Tn},r.a.createElement(lt,Object.assign({},e,{selectedPane:i,setSelectedPane:c}))):r.a.createElement(h.a,{styles:_n},r.a.createElement(lt,Object.assign({},e,{selectedPane:i,setSelectedPane:c}))))),e.callState===Oe.LOBBY&&r.a.createElement(m.a,{horizontal:!0,styles:An},r.a.createElement("div",{className:Vn,style:{width:"100%"}},r.a.createElement(p.a,null,"Waiting to be admitted")))))})),Yn=n(561),Jn={childrenGap:"0.25rem"},qn={childrenGap:"0.75rem"},Xn={childrenGap:"1.5rem"},Qn=Object(x.F)({width:"20.625rem"}),Zn=Object(x.F)({fontSize:"1.375rem",fontWeight:600}),$n=Object(x.F)({fontWeight:600,height:"2.5rem",width:"9.875rem",fontSize:"0.875rem",padding:0}),ea=Object(x.F)({marginRight:"0.375rem",fontSize:"1.375rem"}),ta=Object(x.F)({color:"rgb(0,0,0)",fontSize:"0.875 rem"}),na=function(e){return r.a.createElement(m.a,{verticalAlign:"center",tokens:Jn,className:Qn},r.a.createElement(m.a,{tokens:Xn},r.a.createElement("div",{className:Zn},e.message),r.a.createElement(m.a,{horizontal:!0,tokens:qn},r.a.createElement(rt.a,{className:$n,onClick:e.rejoinHandler},r.a.createElement(Yn.a,{className:ea,size:"medium"}),"Rejoin call"),r.a.createElement(Pt.a,{className:$n,onClick:e.homeHandler},"Go to homepage")),r.a.createElement("div",{className:ta},r.a.createElement("a",{href:"https://docs.microsoft.com/en-us/answers/search.html?c=&includeChildren=&f=&type=question+OR+idea+OR+kbentry+OR+answer+OR+topic+OR+user&redirect=search%2Fsearch&sort=relevance&q=azure-communication-services"},"Give Feedback"),"\xa0on this sample app on Github")))},aa=n(275),ra=n.n(aa),ia=n(276),ca=n.n(ia),oa=Object(x.A)().palette,sa=Object(x.F)({width:"27.25rem",height:"20.125rem",selectors:{"@media (max-width: 67.1875rem)":{display:"none"}}}),la={childrenGap:"3.4375rem"},da={childrenGap:"2.625rem"},ua=(Object(x.F)({listStyleType:"none",fontSize:"0.875rem",margin:0,padding:0,listStylePosition:"outside"}),Object(x.F)({marginRight:"0.4375rem",color:oa.themePrimary}),Object(x.F)({fontWeight:600,fontSize:"2.25rem",maxWidth:"23.188rem"})),ma=Object(x.F)({marginRight:"0.375rem",fontSize:"1.375rem"}),pa=(Object(x.F)({fontWeight:600,fontSize:"0.875rem",width:"7.75rem",height:"2.5rem",borderRadius:3,padding:"0.625rem"}),Object(x.F)({selectors:{"@media (max-width: 53.4375rem)":{padding:"0.625rem"}}})),ha=(Object(x.F)({paddingLeft:"2em",textIndent:"-1em"}),Object(x.F)({overflow:"hidden !important"}),{image:{height:"100%",width:"100%"},root:{}}),ga=function(e){var t=Object(a.useState)(""),n=Object(o.a)(t,2),i=n[0],c=n[1],s=(Object(qt.a)(),{src:ra.a.toString()}),l={src:ca.a.toString()};return r.a.createElement(m.a,{horizontal:!0,horizontalAlign:"center",verticalAlign:"center",tokens:la},r.a.createElement(m.a,{className:pa,tokens:da},r.a.createElement("div",{className:ua},"Banking communication service"),r.a.createElement(m.a.Item,null,r.a.createElement(rt.a,{disabled:""===i,onClick:function(){return e.joinTeamsMeeting(i)}},r.a.createElement(Yn.a,{className:ma,size:"medium"}),"Join a Teams Meeting"),r.a.createElement(at.a,{onChange:function(e,t){c(void 0===t?"":t)}}))),r.a.createElement(pn.a,Object.assign({alt:"Welcome to the Azure Communication Services Calling sample app",className:sa,styles:ha},s)),r.a.createElement(pn.a,Object.assign({alt:"Welcome to the Azure Communication Services Calling sample app",className:sa,styles:ha},l)))},fa=n(587),va=Object(x.A)().palette,ba={root:{marginBottom:0}},Ea={root:{width:"10rem",height:"10.5rem"}},Sa={childrenGap:"0.625rem",padding:"0.625rem"},Oa=Object(x.F)({maxWidth:"25rem",minWidth:"12.5rem",width:"100%",height:"100%",maxHeight:"18.75rem",minHeight:"12.5rem",background:va.neutralLighter,color:va.neutralPrimaryAlt}),Ia=Object(x.F)({height:"2.8125rem",width:"100%",backgroundColor:va.neutralQuaternaryAlt}),Ca=Object(x.F)({width:"100%",height:"100%",maxHeight:"15.9375rem"}),ja=function(e){var t={src:En.a.toString(),imageFit:mn.b.cover,maximizeFrame:!0};return Object(a.useEffect)((function(){return Object(d.a)(l.a.mark((function t(){var n,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.localVideoStream){t.next=7;break}return n=new E.VideoStreamRenderer(e.localVideoStream),t.next=4,n.createView({scalingMode:"Crop"});case 4:st=t.sent,(a=document.getElementById(Oe.CONFIGURATION_LOCAL_VIDEO_PREVIEW_ID))&&0===a.childElementCount&&a.appendChild(st.target);case 7:case"end":return t.stop()}}),t)})))(),function(){st&&(st.dispose(),st=void 0)}}),[e.localVideoStream]),r.a.createElement(m.a,{className:Oa},r.a.createElement(m.a,{horizontalAlign:"center",verticalAlign:"center",id:Oe.CONFIGURATION_LOCAL_VIDEO_PREVIEW_ID,className:Ca},!e.localVideoStream&&r.a.createElement(pn.a,Object.assign({styles:Ea},t,{"aria-label":"Local video preview image"}))),r.a.createElement(m.a,{horizontal:!0,horizontalAlign:"center",verticalAlign:"center",tokens:Sa,className:Ia},r.a.createElement(S.a,{size:"medium"}),r.a.createElement(fa.a,{onKeyDownCapture:function(e){e.preventDefault()},checked:void 0!==e.localVideoStream,styles:ba,disabled:!e.videoDeviceInfo||0===e.videoDeviceList.length,onChange:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=new E.LocalVideoStream(e.videoDeviceInfo);e.setLocalVideoStream(n?a:void 0)},ariaLabel:"Video Icon"}),r.a.createElement(I.a,{size:"medium"}),r.a.createElement(fa.a,{checked:e.mic,styles:ba,disabled:!e.audioDeviceInfo||0===e.audioDeviceList.length,onChange:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.setMic(n)},ariaLabel:"Microphone Icon"})))},wa={childrenGap:"3rem"},ya=Object(x.F)({marginRight:"0.375rem",fontSize:"1.375rem"}),xa=Object(x.F)({fontWeight:600,fontSize:"0.875rem",height:"2.75rem",width:"100%",marginTop:"2.125rem",maxWidth:"18.75rem",minWidth:"12.5rem"}),ka=Object(x.F)({maxWidth:"46.875rem",width:"100%",height:"100%",selectors:{"@media (max-width: 750px)":{padding:"0.625rem",height:"100%"}}}),Da=Object(x.F)({width:"100%",maxWidth:"18.75rem"}),Ra=Object(x.F)({height:"100%",width:"100%"}),Na=Object(x.F)({height:"100%",width:"100%",justifyContent:"space-evenly"}),Aa=(Object(x.F)({minWidth:"12.5rem"}),Object(x.F)({boxSizing:"border-box",height:"2.5rem",width:"18.75rem",border:"1px solid #605e5c",borderRadius:"2px",backgroundColor:"#FFFFFF"})),Pa=Object(x.F)({fontSize:"0.875rem",fontWeight:600,lineHeight:"1.5rem","::-webkit-input-placeholder":{fontSize:"0.875rem",fontWeight:600},"::-moz-placeholder":{fontSize:"0.875rem",fontWeight:600},":-moz-placeholder":{fontSize:"0.875rem",fontWeight:600}}),Ta=Object(x.F)({boxSizing:"border-box",height:"2.5rem",width:"18.75rem",border:"1px solid #e81123",borderRadius:"2px",backgroundColor:"#FFFFFF",fontSize:"0.875rem"}),_a=Object(x.F)({fontSize:"0.875rem",fontWeight:600,color:"rgb(50, 49, 48)",boxSizing:"border-box",boxShadow:"none",margin:0,display:"inline-block",padding:"5px 0px",overflowWrap:"break-word"}),La=Object(x.F)({width:"18.75rem",backgroundColor:"#FFFFFF",marginTop:"0.188rem",marginBottom:"0.188rem",marginLeft:"0.188rem",color:"#e81123",fontSize:".7375rem",fontWeight:"400"}),Fa={wrapper:{height:"2.3rem"},fieldGroup:{height:"2.3rem"}},Va=function(e){return r.a.createElement("div",null,r.a.createElement("div",{className:_a},"Name"),r.a.createElement(at.a,{autoComplete:"off",inputClassName:Pa,ariaLabel:"Choose your name",borderless:!0,className:e.isEmpty?Ta:Aa,onChange:function(t){e.setName(t.target.value),t.target.value?e.setEmptyWarning(!1):e.setEmptyWarning(!0)},id:"name",placeholder:"Enter your name",defaultValue:e.name,styles:Fa}),e.isEmpty&&r.a.createElement("div",{role:"alert",className:La}," ","Name cannot be empty"," "))},Ma=Object(u.b)((function(e,t){return{deviceManager:e.devices.deviceManager,callClient:e.sdk.callClient,callAgent:e.calls.callAgent,mic:e.controls.mic,screenWidth:t.screenWidth,localVideoStream:e.streams.localVideoStream,audioDeviceInfo:e.devices.audioDeviceInfo,videoDeviceInfo:e.devices.videoDeviceInfo,videoDeviceList:e.devices.videoDeviceList,audioDeviceList:e.devices.audioDeviceList,cameraPermission:e.devices.cameraPermission,microphonePermission:e.devices.microphonePermission}}),(function(e,t){return{setLocalVideoStream:function(t){return e(me(t))},setMic:function(t){return e(te(t))},setAudioDeviceInfo:function(t){return e(ce(t))},setVideoDeviceInfo:function(t){return e(oe(t))},setupCallClient:function(t){return e(function(e){return function(){var t=Object(d.a)(l.a.mark((function t(n,a){var r,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!K.isOnIphoneAndNotSafari()&&!K.isUnsupportedBrowser()){t.next=3;break}return e(),t.abrupt("return");case 3:t.prev=3,Object(he.setLogLevel)("verbose"),r=new E.CallClient,t.next=12;break;case 8:return t.prev=8,t.t0=t.catch(3),e(),t.abrupt("return");case 12:if(r){t.next=14;break}return t.abrupt("return");case 14:return t.next=16,r.getDeviceManager();case 16:i=t.sent,n(ue(r)),n(ae(i)),xe(i,n,a);case 20:case"end":return t.stop()}}),t,null,[[3,8]])})));return function(e,n){return t.apply(this,arguments)}}()}(t))},setupCallAgent:function(n,a){return e(function(e,t,n){return function(){var a=Object(d.a)(l.a.mark((function a(r,i){var c,o,s,d,u;return l.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,K.getTokenForUser();case 2:return c=a.sent,o=c.token,s=c.user.communicationUserId,r(de(s)),d=new H.a({tokenRefresher:function(){return K.getRefreshedTokenForUser(s)},refreshProactively:!0,token:o}),a.next=9,e.createCallAgent(d,{displayName:t});case 9:if(void 0!==(u=a.sent)){a.next=12;break}return a.abrupt("return");case 12:r(Y(u)),u.on("callsUpdated",(function(e){e.added.forEach((function(e){console.log("Call added : Call Id = ".concat(e.id));var t=i();t.calls.call&&"Incoming"===e.direction?e.hangUp():(r(J(e)),e.on("stateChanged",(function(){r(X(e.state)),"Connected"===e.state&&e.info.getServerCallId().then((function(e){console.log("Conversation URL is - "+e),r({type:"SET_SERVER_CALL_ID",serverCallId:e})})).catch((function(e){console.log(e)}))})),r(X(e.state)),e.on("isScreenSharingOnChanged",(function(){r(ne(e.isScreenSharingOn))})),r(ne(e.isScreenSharingOn)),e.api(E.Features.Recording).on("isRecordingActiveChanged",(function(){var t=e.api(E.Features.Recording).isRecordingActive;t?r({type:"START_RECORDING",status:"STARTED"}):t||r({type:"STOP_RECORDING",status:"STOPPED"}),r(Z(t))})),r(Z(e.api(E.Features.Recording).isRecordingActive)),e.api(E.Features.Transcription).on("isTranscriptionActiveChanged",(function(){r($(e.api(E.Features.Transcription).isTranscriptionActive))})),r($(e.api(E.Features.Transcription).isTranscriptionActive)),e.on("remoteParticipantsUpdated",(function(n){n.added.forEach((function(n){je(n,e,r),r(Q([].concat(Object(U.a)(t.calls.remoteParticipants),[n])))})),n.removed.length>0&&r(Q(Object(U.a)(e.remoteParticipants.values())))})),r(Q(Object(U.a)(t.calls.remoteParticipants))))})),e.removed.forEach((function(e){var t=i();if(t.calls.call&&t.calls.call===e){if(r(q(e)),e.callEndReason&&0===e.callEndReason.code&&5854===e.callEndReason.subCode)return void(e.callEndReason&&n(e.callEndReason));if(e.callEndReason&&0!==e.callEndReason.code)return void(e.callEndReason&&n(e.callEndReason))}}))}));case 14:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}()}(n,a,t.callEndedHandler))},updateDevices:function(){return e(function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a,r,i,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n(),null!=(r=a.devices.deviceManager)){e.next=5;break}return console.error("no device manager available"),e.abrupt("return");case 5:return e.next=7,r.getCameras();case 7:return i=e.sent,t(le(i)),e.next=11,r.getMicrophones();case 11:c=e.sent,t(se(c));case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}}}))((function(e){var t=Object(a.useState)("user"+Math.ceil(1e3*Math.random())),n=Object(o.a)(t,2),i=n[0],c=n[1],s=Object(a.useState)(!1),u=Object(o.a)(s,2),p=u[0],h=u[1],g=e.setupCallClient,f=e.setupCallAgent,v=e.unsupportedStateHandler,b=e.callClient,E=Object(a.useCallback)((function(){return g(v)}),[v]);return Object(a.useEffect)((function(){E()}),[E]),r.a.createElement(m.a,{className:ka,horizontalAlign:"center",verticalAlign:"center"},e.deviceManager?r.a.createElement(m.a,{className:e.screenWidth>750?Ra:Na,horizontal:e.screenWidth>750,horizontalAlign:"center",verticalAlign:"center",tokens:e.screenWidth>750?wa:void 0},r.a.createElement(ja,{mic:e.mic,setMic:e.setMic,setLocalVideoStream:e.setLocalVideoStream,videoDeviceInfo:e.videoDeviceInfo,audioDeviceInfo:e.audioDeviceInfo,localVideoStream:e.localVideoStream,videoDeviceList:e.videoDeviceList,audioDeviceList:e.audioDeviceList}),r.a.createElement(m.a,{className:Da},r.a.createElement(Va,{setName:c,name:i,setEmptyWarning:h,isEmpty:p}),r.a.createElement("div",null,r.a.createElement(B,{videoDeviceList:e.videoDeviceList,audioDeviceList:e.audioDeviceList,audioDeviceInfo:e.audioDeviceInfo,videoDeviceInfo:e.videoDeviceInfo,setVideoDeviceInfo:e.setVideoDeviceInfo,setAudioDeviceInfo:e.setAudioDeviceInfo,deviceManager:e.deviceManager})),r.a.createElement("div",null,r.a.createElement(rt.a,{className:xa,onClick:Object(d.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i){t.next=4;break}h(!0),t.next=8;break;case 4:return h(!1),t.next=7,f(b,i);case 7:e.startCallHandler();case 8:case"end":return t.stop()}}),t)})))},r.a.createElement(Yn.a,{className:ya,size:"medium"}),"Start call")))):r.a.createElement(On.a,{label:"Initializing call client...",ariaLive:"assertive",labelPosition:"top"}))})),za=n(563),Wa=n(487).dependencies["@azure/communication-calling"],Ba="Last Updated ".concat(K.getBuildTime()," with @azure/communication-calling:").concat(Wa);Object(x.D)({}),Object(za.a)(),he.AzureLogger.log=function(){Jt.push.apply(Jt,arguments)};window.setTimeout((function(){try{console.log("Azure Communication Services sample group calling app: ".concat(Ba))}catch(e){}}),0);var Ua=function(){var e=Object(a.useState)("home"),t=Object(o.a)(e,2),n=t[0],i=t[1],c=Object(a.useState)(),s=Object(o.a)(c,2),l=s[0],d=s[1],m=Object(a.useState)(0),p=Object(o.a)(m,2),h=p[0],g=p[1],f=Object(a.useCallback)((function(){return i("unsupported")}),[]);Object(a.useEffect)((function(){var e=function(){var e="undefined"!==typeof window?window.innerWidth:0;g(e)};return e(),window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]);var v=function(){return new URLSearchParams(window.location.search).get("groupId")},b=function(){var e=new URLSearchParams(window.location.search).get("meeting");return e?decodeURIComponent(e):""},E=function(){var e=v();return e||""},S=function(){var e=b();return""===e?{groupId:E()}:{meetingLink:e}};return b()&&"home"===n&&i("configuration"),v()&&"home"===n&&i("configuration"),r.a.createElement(u.a,{store:Yt},"home"===n?r.a.createElement(ga,{startCallHandler:function(e){window.location.href=window.location.href+"?groupId="+encodeURIComponent(e)},joinTeamsMeeting:function(e){window.location.href=window.location.href+"?meeting="+encodeURIComponent(e)}}):"configuration"===n?r.a.createElement(Ma,{startCallHandler:function(){return i("call")},unsupportedStateHandler:f,callEndedHandler:function(e){d(e),i("error")},screenWidth:h}):"call"===n?r.a.createElement(Kn,{endCallHandler:function(){return i("endCall")},locator:S(),screenWidth:h}):"endCall"===n?r.a.createElement(na,{message:"You left the call",rejoinHandler:function(){return window.location.reload()},homeHandler:function(){window.location.href=window.location.href.split("?")[0]}}):"unsupported"===n?(window.document.title="Unsupported browser",r.a.createElement(r.a.Fragment,null,r.a.createElement("a",{href:"https://docs.microsoft.com/en-us/azure/communication-services/concepts/voice-video-calling/calling-sdk-features#calling-client-library-browser-support"},"Learn more"),"\xa0about browsers and platforms supported by the web calling sdk")):"error"===n?(window.document.title="Call Ended",r.a.createElement("div",null,r.a.createElement("div",null,"The call has ended with this error code (Code: ".concat(null===l||void 0===l?void 0:l.code," Subcode: ").concat(null===l||void 0===l?void 0:l.subCode,")")),r.a.createElement("div",null,r.a.createElement("a",{href:"https://docs.microsoft.com/en-us/azure/communication-services/concepts/troubleshooting-info?tabs=csharp%2Cjavascript%2Cdotnet"},"Learn more"),"\xa0about why this Azure Communication Services call has ended."))):r.a.createElement(r.a.Fragment,null))},Ha=n(562),Ga=n(277),Ka=n(282),Ya=n(283),Ja={componentStyles:{SvgIcon:Ga.a},componentVariables:{SvgIcon:Ka.a},siteVariables:Ya};c.a.render(r.a.createElement(Ha.a,{theme:Ja,className:"wrapper"},r.a.createElement(Ua,null)),document.getElementById("root"))},92:function(e,t,n){e.exports=n.p+"static/media/staticmedia.3545b0ef.svg"}},[[308,1,2]]]);
//# sourceMappingURL=main.7113e9ff.chunk.js.map